@using HMS.Web.Models.ViewModels.Auth
@model RegisterViewModel
@{
    ViewData["Title"] = "Create Account - Medixus Healthcare";
    Layout = null;
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewData["Title"]</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="~/css/auth.css">
</head>
<body>
    <div class="auth-wrapper">
        <div class="auth-container">
            <!-- Left Illustration Panel -->
            <div class="auth-illustration">
                <a href="/" class="brand-logo">
                    <i class="fas fa-heartbeat"></i>
                    <span>Medixus</span>
                </a>

                <div class="illustration-content">
                    <h2>Healthcare, Simplified</h2>
                    <p>Join thousands who trust Medixus for care that's simple, personal, and always close. Start your journey to better health today.</p>

                    <div class="feature-list">
                        <div class="feature-item">
                            <i class="fas fa-search"></i>
                            <span>Find a Doctor</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-calendar-check"></i>
                            <span>Easy Scheduling</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-file-medical"></i>
                            <span>Digital Records</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-comments"></i>
                            <span>24/7 Support</span>
                        </div>
                    </div>
                </div>

                <div class="auth-stats">
                    <div class="stat-item">
                        <div class="stat-number">178+</div>
                        <div class="stat-label">Save Products</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">190+</div>
                        <div class="stat-label">Sales Products</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">12+</div>
                        <div class="stat-label">Job Application</div>
                    </div>
                </div>
            </div>

            <!-- Right Form Panel -->
            <div class="auth-content">
                <div class="auth-header">
                    <h1>Create Your Account</h1>
                    <p class="auth-subtitle">Start your journey to better health</p>
                </div>

                <form id="registerForm" method="post" asp-controller="Auth" asp-action="Register">
                    @Html.AntiForgeryToken()

                    @if (TempData["Success"] != null)
                    {
                        <div class="alert alert-success">
                            <i class="fas fa-check-circle"></i>
                            <div>@TempData["Success"]</div>
                        </div>
                    }

                    @if (ViewData.ModelState.IsValid == false)
                    {
                        <div class="alert alert-danger">
                            <i class="fas fa-exclamation-circle"></i>
                            <div>
                                @foreach (var modelState in ViewData.ModelState.Values)
                                {
                                    foreach (var error in modelState.Errors)
                                    {
                                        <p>@error.ErrorMessage</p>
                                    }
                                }
                            </div>
                        </div>
                    }

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div class="form-group">
                            <label class="form-label" for="firstName">
                                <i class="fas fa-user"></i>
                                <span>First Name</span>
                            </label>
                            <div class="input-wrapper">
                                <input type="text" class="form-control" id="firstName" asp-for="FirstName"
                                       placeholder="John" required autofocus>
                                <i class="fas fa-user input-icon"></i>
                            </div>
                            <span asp-validation-for="FirstName" class="text-danger"></span>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="lastName">
                                <i class="fas fa-user"></i>
                                <span>Last Name</span>
                            </label>
                            <div class="input-wrapper">
                                <input type="text" class="form-control" id="lastName" asp-for="LastName"
                                       placeholder="Doe" required>
                                <i class="fas fa-user input-icon"></i>
                            </div>
                            <span asp-validation-for="LastName" class="text-danger"></span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="email">
                            <i class="fas fa-envelope"></i>
                            <span>Email Address</span>
                        </label>
                        <div class="input-wrapper">
                            <input type="email" class="form-control" id="email" asp-for="Email"
                                   placeholder="john.doe@example.com" required>
                            <i class="fas fa-envelope input-icon"></i>
                        </div>
                        <span asp-validation-for="Email" class="text-danger"></span>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="phone">
                            <i class="fas fa-phone"></i>
                            <span>Phone Number</span>
                        </label>
                        <div class="input-wrapper">
                            <input type="tel" class="form-control" id="phone" asp-for="PhoneNumber"
                                   placeholder="+1 (555) 123-4567" required>
                            <i class="fas fa-phone input-icon"></i>
                        </div>
                        <span asp-validation-for="PhoneNumber" class="text-danger"></span>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="dob">
                            <i class="fas fa-calendar"></i>
                            <span>Date of Birth</span>
                        </label>
                        <div class="input-wrapper">
                            <input type="date" class="form-control" id="dob" asp-for="DateOfBirth"
                                   max="@DateTime.Now.AddYears(-18).ToString("yyyy-MM-dd")" required>
                            <i class="fas fa-calendar input-icon"></i>
                        </div>
                        <span asp-validation-for="DateOfBirth" class="text-danger"></span>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="password">
                            <i class="fas fa-lock"></i>
                            <span>Password</span>
                        </label>
                        <div class="input-wrapper">
                            <input type="password" class="form-control" id="password" asp-for="Password"
                                   placeholder="Create a strong password" required>
                            <i class="fas fa-lock input-icon"></i>
                            <button type="button" class="password-toggle">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <div class="password-strength">
                            <div class="strength-bar">
                                <div class="strength-bar-fill"></div>
                            </div>
                            <div class="strength-text">Password strength: <span id="strengthText">Weak</span></div>
                        </div>
                        <span asp-validation-for="Password" class="text-danger"></span>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="confirmPassword">
                            <i class="fas fa-lock"></i>
                            <span>Confirm Password</span>
                        </label>
                        <div class="input-wrapper">
                            <input type="password" class="form-control" id="confirmPassword"
                                   asp-for="ConfirmPassword" placeholder="Re-enter your password" required>
                            <i class="fas fa-lock input-icon"></i>
                            <button type="button" class="password-toggle">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <span asp-validation-for="ConfirmPassword" class="text-danger"></span>
                    </div>

                    <div class="form-check" style="margin-bottom: 1.5rem;">
                        <input type="checkbox" id="terms" required>
                        <label for="terms">
                            I agree to the <a href="/terms" style="color: var(--primary); text-decoration: none; font-weight: 600;">Terms of Service</a> and <a href="/privacy" style="color: var(--primary); text-decoration: none; font-weight: 600;">Privacy Policy</a>
                        </label>
                    </div>

                    <button type="submit" class="btn btn-primary btn-block">
                        <i class="fas fa-user-plus"></i>
                        <span>Create Account</span>
                    </button>

                    <div class="auth-divider">
                        <span>Or continue with</span>
                    </div>

                    <div class="social-login">
                        <button type="button" class="btn btn-social">
                            <i class="fab fa-google"></i>
                            <span>Google</span>
                        </button>
                        <button type="button" class="btn btn-social">
                            <i class="fab fa-microsoft"></i>
                            <span>Microsoft</span>
                        </button>
                        <button type="button" class="btn btn-social">
                            <i class="fab fa-apple"></i>
                            <span>Apple</span>
                        </button>
                    </div>

                    <div class="auth-footer">
                        <p>Already have an account? <a asp-controller="Auth" asp-action="Login">Sign In</a></p>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Password strength indicator
            const passwordInput = document.getElementById('password');
            const strengthBarFill = document.querySelector('.strength-bar-fill');
            const strengthText = document.getElementById('strengthText');

            function checkPasswordStrength(password) {
                let strength = 0;
                let className = 'weak';
                let text = 'Weak';

                if (password.length >= 8) strength++;
                if (/[A-Z]/.test(password)) strength++;
                if (/[a-z]/.test(password)) strength++;
                if (/[0-9]/.test(password)) strength++;
                if (/[^A-Za-z0-9]/.test(password)) strength++;

                if (strength === 5) {
                    className = 'strong';
                    text = 'Strong';
                } else if (strength >= 3) {
                    className = 'medium';
                    text = 'Medium';
                }

                strengthBarFill.className = 'strength-bar-fill ' + className;
                strengthText.textContent = text;
            }

            passwordInput.addEventListener('input', function() {
                checkPasswordStrength(this.value);
            });

            // Password visibility toggle
            document.querySelectorAll('.password-toggle').forEach(toggle => {
                toggle.addEventListener('click', function() {
                    const input = this.parentElement.querySelector('input');
                    const icon = this.querySelector('i');

                    if (input.type === 'password') {
                        input.type = 'text';
                        icon.classList.remove('fa-eye');
                        icon.classList.add('fa-eye-slash');
                    } else {
                        input.type = 'password';
                        icon.classList.remove('fa-eye-slash');
                        icon.classList.add('fa-eye');
                    }
                });
            });

            // Form validation
            const form = document.getElementById('registerForm');
            form.addEventListener('submit', function(e) {
                const password = document.getElementById('password').value;
                const confirmPassword = document.getElementById('confirmPassword').value;

                if (password !== confirmPassword) {
                    e.preventDefault();
                    alert('Passwords do not match!');
                    return false;
                }

                if (!document.getElementById('terms').checked) {
                    e.preventDefault();
                    alert('Please agree to the Terms of Service and Privacy Policy');
                    return false;
                }
            });

            // Auto-format phone number
            const phoneInput = document.getElementById('phone');
            phoneInput.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');

                if (value.length > 0) {
                    if (!value.startsWith('1') && value.length >= 10) {
                        value = '1' + value;
                    }

                    // Format: +1 (XXX) XXX-XXXX
                    let formatted = '+';
                    if (value.length > 0) formatted += value.substring(0, 1);
                    if (value.length > 1) formatted += ' (' + value.substring(1, 4);
                    if (value.length > 4) formatted += ') ' + value.substring(4, 7);
                    if (value.length > 7) formatted += '-' + value.substring(7, 11);

                    e.target.value = formatted;
                }
            });
        });
    </script>
</body>
</html>